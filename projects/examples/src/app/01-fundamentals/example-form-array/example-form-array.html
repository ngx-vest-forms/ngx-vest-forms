<form [ngxVestForm]="form" (submit)="save()" class="form-container">
  <!-- Add Interest Field -->
  <div class="form-field">
    <label class="form-label" for="addInterest"> Add a new interest * </label>
    <div class="flex gap-3">
      <div class="flex-1">
        <input
          #addInterestInput
          id="addInterest"
          class="form-input"
          type="text"
          [value]="addInterestValue()"
          (input)="addInterestValue.set($any($event.target).value)"
          placeholder="Enter an interest"
          [attr.aria-invalid]="addInterestShowError() ? 'true' : null"
          [attr.aria-describedby]="addInterestShowError() ? 'addInterest-error' : null"
        />
        @if (addInterestShowError() && addInterestError()) {
        <div role="alert" id="addInterest-error" class="text-destructive mt-1">
          {{ addInterestError() }}
        </div>
        }
      </div>
      <button
        type="button"
        (click)="addInterest()"
        class="btn-secondary whitespace-nowrap"
        [disabled]="form.pending()"
      >
        <span aria-hidden="true">+</span>
        <span>Add Interest</span>
      </button>
    </div>
  </div>

  <!-- Current Interests List -->
  <div class="form-field">
    <h3 class="form-label">Current interests</h3>
    @let entries = interestEntries(); @if (entries.length > 0) {
    <div class="space-y-3">
      @for (entry of entries; track entry.key) {
      <div
        class="flex items-center gap-3 rounded-md border border-gray-200 bg-gray-50 p-3"
      >
        <div class="flex-1">
          <input
            type="text"
            [value]="entry.field.value() ?? ''"
            (input)="entry.field.set($event)"
            class="form-input"
            [attr.aria-label]="'Interest ' + (entry.index + 1)"
          />
          <ngx-form-error [field]="entry.field" />
        </div>
        <button
          type="button"
          (click)="removeInterest(entry.index)"
          class="btn-danger inline-flex items-center justify-center gap-1.5 px-3 py-2 text-sm font-medium transition-all hover:scale-105"
          [attr.aria-label]="
            'Remove interest ' +
            (entry.field.value() ? entry.field.value() : entry.index + 1)
          "
        >
          <span aria-hidden="true" class="text-2xl leading-none">Ã—</span>
          <span class="hidden sm:inline">Remove</span>
        </button>
      </div>
      }
    </div>
    } @else {
    <div
      class="rounded-md border-2 border-dashed border-gray-300 bg-gray-50 py-8 text-center"
    >
      <p class="text-gray-500">
        No interests added yet. Add your first interest above!
      </p>
    </div>
    }
  </div>

  <!-- Form Actions -->
  <div class="form-actions">
    <button
      type="submit"
      class="btn-primary"
      [disabled]="!form.valid() || form.pending() || form.submitting()"
    >
      @if (form.submitting()) { Submitting... } @else { Submit Form }
    </button>
    <button type="button" (click)="resetForm()" class="btn-secondary">
      Reset
    </button>
  </div>
</form>
