<form
  (ngSubmit)="onSubmit()"
  class="form-container"
  [attr.aria-busy]="form.pending()"
>
  <!-- Add Interest Field -->
  <div class="form-field">
    <label class="form-label" for="addInterest"> Add a new interest * </label>
    <div class="flex gap-3">
      <div class="flex-1">
        <input
          id="addInterest"
          #addInterestInput
          class="form-input"
          type="text"
          [value]="form.addInterest() || ''"
          (input)="form.setAddInterest($event)"
          (blur)="form.touchAddInterest()"
          placeholder="Enter an interest"
          [attr.aria-invalid]="showAddInterestErrors() || null"
          [attr.aria-describedby]="
              showAddInterestErrors() ? 'addInterest-error' : null
            "
        />
        @if (showAddInterestErrors()) {
        <div class="form-error" id="addInterest-error" role="alert">
          {{ addInterestErrorMessage() }}
        </div>
        }
      </div>
      <button
        type="button"
        (click)="addInterest()"
        class="btn-secondary whitespace-nowrap"
        [disabled]="form.pending()"
      >
        <span aria-hidden="true">+</span>
        <span>Add Interest</span>
      </button>
    </div>
  </div>

  <!-- Current Interests List -->
  <div class="form-field">
    <h3 class="form-label">Current interests</h3>
    @let entries = interestEntries(); @if (entries.length > 0) {
    <div class="space-y-3">
      @for (entry of entries; track entry.key) {
      <div
        class="flex items-center gap-3 rounded-md border border-gray-200 bg-gray-50 p-3"
      >
        <div class="flex-1">
          <input
            type="text"
            [value]="entry.field.value() ?? ''"
            (input)="entry.field.set($event)"
            (blur)="entry.field.touch()"
            class="form-input"
            [attr.aria-label]="'Interest ' + (entry.index + 1)"
            [attr.aria-invalid]="entry.field.showErrors() && entry.field.errors().length > 0"
            [attr.aria-describedby]="
                    entry.field.showErrors() && entry.field.errors().length > 0
                      ? 'interest-error-' + entry.index
                      : null
                  "
          />
          @if (entry.field.showErrors() && entry.field.errors().length > 0) {
          <div
            class="form-error"
            [attr.id]="'interest-error-' + entry.index"
            role="alert"
          >
            @for (error of entry.field.errors(); track error) {
            <div>{{ error }}</div>
            }
          </div>
          }
        </div>
        <button
          type="button"
          (click)="removeInterest(entry.index)"
          class="btn-danger inline-flex items-center justify-center gap-1.5 px-3 py-2 text-sm font-medium transition-all hover:scale-105"
          [attr.aria-label]="
            'Remove interest ' +
            (entry.field.value() ? entry.field.value() : entry.index + 1)
          "
        >
          <span aria-hidden="true" class="text-2xl leading-none">Ã—</span>
          <span class="hidden sm:inline">Remove</span>
        </button>
      </div>
      }
    </div>
    } @else {
    <div
      class="rounded-md border-2 border-dashed border-gray-300 bg-gray-50 py-8 text-center"
    >
      <p class="text-gray-500">
        No interests added yet. Add your first interest above!
      </p>
    </div>
    }
  </div>

  <!-- Form Actions -->
  <div class="form-actions">
    <button
      type="submit"
      class="btn-primary"
      [disabled]="!form.valid() || form.pending() || form.submitting()"
    >
      @if (form.submitting()) { Submitting... } @else { Submit Form }
    </button>
    <button type="button" (click)="resetForm()" class="btn-secondary">
      Reset
    </button>
  </div>
</form>
