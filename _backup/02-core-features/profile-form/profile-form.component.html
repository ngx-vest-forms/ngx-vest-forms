<section>
  <div class="nv-prose mb-4 max-w-none">
    <h2>Profile Form</h2>
    <p>
      Purpose: Comprehensive example with nested objects, conditional fields,
      and multiple input types. Demonstrates how template-driven forms scale
      with <code>ngx-vest-forms</code>.
    </p>
    <p class="text-sm">
      See:
      <a
        href="https://github.com/simplifiedcourses/ngx-vest-forms"
        target="_blank"
        >README</a
      >
      Â· <a href="https://vestjs.dev" target="_blank">Vest Docs</a>
    </p>
  </div>
  <p class="nv-hint">
    Comprehensive form with nested objects, various input types, conditional
    validation, and file upload.
  </p>

  <form
    ngxVestFormCore
    [vestSuite]="suite"
    [(formValue)]="formValue"
    (ngSubmit)="save(vestForm.formState().valid)"
    #vestForm="ngxVestFormCore"
    class="nv-form"
  >
    <!-- Personal Information Section -->
    <div class="form-section">
      <h4 class="form-section-title">Personal Information</h4>

      <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
        <!-- First Name -->
        <div class="nv-field">
          <label class="nv-label">
            First Name *
            <input
              type="text"
              name="firstName"
              ngModel
              placeholder="Enter your first name"
              class="nv-input"
              [attr.aria-invalid]="
                (vestForm.formState().errors['firstName']?.length || 0) > 0
                  ? 'true'
                  : 'false'
              "
            />
          </label>
          <ul class="nv-errors" aria-live="polite">
            @for (
              msg of vestForm.formState().errors['firstName'] || [];
              track msg
            ) {
              <li class="nv-error">{{ msg }}</li>
            }
          </ul>
        </div>

        <!-- Last Name -->
        <div class="nv-field">
          <label class="nv-label">
            Last Name *
            <input
              type="text"
              name="lastName"
              ngModel
              placeholder="Enter your last name"
              class="nv-input"
              [attr.aria-invalid]="
                (vestForm.formState().errors['lastName']?.length || 0) > 0
                  ? 'true'
                  : 'false'
              "
            />
          </label>
          <ul class="nv-errors" aria-live="polite">
            @for (
              msg of vestForm.formState().errors['lastName'] || [];
              track msg
            ) {
              <li class="nv-error">{{ msg }}</li>
            }
          </ul>
        </div>
      </div>

      <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
        <!-- Email -->
        <div class="nv-field">
          <label class="nv-label">
            Email *
            <input
              type="email"
              name="email"
              ngModel
              placeholder="Enter your email"
              class="nv-input"
              [attr.aria-invalid]="
                (vestForm.formState().errors['email']?.length || 0) > 0
                  ? 'true'
                  : 'false'
              "
            />
          </label>
          <ul class="nv-errors" aria-live="polite">
            @for (
              msg of vestForm.formState().errors['email'] || [];
              track msg
            ) {
              <li class="nv-error">{{ msg }}</li>
            }
          </ul>
        </div>

        <!-- Phone -->
        <div class="nv-field">
          <label class="nv-label">
            Phone Number *
            <input
              type="tel"
              name="phone"
              ngModel
              placeholder="Enter your phone number"
              class="nv-input"
              [attr.aria-invalid]="
                (vestForm.formState().errors['phone']?.length || 0) > 0
                  ? 'true'
                  : 'false'
              "
            />
          </label>
          <ul class="nv-errors" aria-live="polite">
            @for (
              msg of vestForm.formState().errors['phone'] || [];
              track msg
            ) {
              <li class="nv-error">{{ msg }}</li>
            }
          </ul>
        </div>
      </div>

      <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
        <!-- Date of Birth -->
        <div class="nv-field">
          <label class="nv-label">
            Date of Birth *
            <input type="date" name="dateOfBirth" ngModel class="nv-input" />
          </label>
        </div>

        <!-- Gender -->
        <div class="nv-field">
          <label class="nv-label">
            Gender *
            <select name="gender" ngModel class="nv-select">
              @for (option of genderOptions; track option.value) {
                <option [value]="option.value">{{ option.label }}</option>
              }
            </select>
          </label>
        </div>
      </div>

      <!-- Gender Other (Conditional) -->
      @if (formValue().gender === 'other') {
        <div class="nv-field">
          <label class="nv-label">
            Please Specify *
            <input
              type="text"
              name="genderOther"
              ngModel
              placeholder="Please specify your gender"
              class="nv-input"
            />
          </label>
        </div>
      }
    </div>

    <!-- Address Section -->
    <div class="form-section">
      <h4 class="form-section-title">Address</h4>

      <!-- Street Address -->
      <div class="nv-field">
        <label class="nv-label">
          Street Address *
          <input
            type="text"
            name="address.street"
            ngModel
            placeholder="Enter your street address"
            class="nv-input"
          />
        </label>
      </div>

      <div class="grid grid-cols-1 gap-4 md:grid-cols-3">
        <!-- City -->
        <div class="nv-field">
          <label class="nv-label">
            City *
            <input
              type="text"
              name="address.city"
              ngModel
              placeholder="City"
              class="nv-input"
            />
          </label>
        </div>

        <!-- State -->
        <div class="nv-field">
          <label class="nv-label">
            State *
            <input
              type="text"
              name="address.state"
              ngModel
              placeholder="State"
              class="nv-input"
            />
          </label>
        </div>

        <!-- ZIP Code -->
        <div class="nv-field">
          <label class="nv-label">
            ZIP Code *
            <input
              type="text"
              name="address.zipCode"
              ngModel
              placeholder="ZIP Code"
              class="nv-input"
            />
          </label>
        </div>
      </div>

      <!-- Country -->
      <div class="nv-field">
        <label class="nv-label">
          Country *
          <select name="address.country" ngModel class="nv-select">
            @for (country of countries; track country.value) {
              <option [value]="country.value">{{ country.label }}</option>
            }
          </select>
        </label>
      </div>
    </div>

    <!-- Bio and Website Section -->
    <div class="form-section">
      <h4 class="form-section-title">About You</h4>

      <!-- Bio -->
      <div class="nv-field">
        <label class="nv-label">
          Bio *
          <textarea
            name="bio"
            ngModel
            rows="4"
            placeholder="Tell us about yourself (minimum 10 characters)"
            class="nv-input"
          ></textarea>
        </label>
        <div class="nv-hint">
          @if (formValue().bio) {
            {{ formValue().bio.length }}/500 characters
          } @else {
            0/500 characters
          }
        </div>
      </div>

      <!-- Website -->
      <div class="nv-field">
        <label class="nv-label">
          Website (Optional)
          <input
            type="url"
            name="website"
            ngModel
            placeholder="https://your-website.com"
            class="nv-input"
          />
        </label>
      </div>
    </div>

    <!-- Preferences Section -->
    <div class="form-section">
      <h4 class="form-section-title">Preferences</h4>

      <!-- Newsletter -->
      <div class="nv-field">
        <label class="nv-label flex items-center">
          <input type="checkbox" name="newsletter" ngModel class="nv-input" />
          <span class="ms-2"> Subscribe to our newsletter </span>
        </label>
      </div>

      <!-- Notifications -->
      <div class="form-group">
        <span class="form-label"> Notification Preferences </span>

        <div class="nv-field">
          <label class="nv-label flex items-center">
            <input
              type="checkbox"
              name="notifications.email"
              ngModel
              class="nv-input"
            />
            <span class="ms-2"> Email notifications </span>
          </label>
        </div>

        <div class="nv-field">
          <label class="nv-label flex items-center">
            <input
              type="checkbox"
              name="notifications.sms"
              ngModel
              class="nv-input"
            />
            <span class="ms-2"> SMS notifications </span>
          </label>
        </div>

        <div class="nv-field">
          <label class="nv-label flex items-center">
            <input
              type="checkbox"
              name="notifications.push"
              ngModel
              class="nv-input"
            />
            <span class="ms-2"> Push notifications </span>
          </label>
        </div>
      </div>
    </div>

    <!-- Profile Picture Section -->
    <div class="form-section">
      <h4 class="form-section-title">Profile Picture</h4>

      <div class="nv-field">
        <label class="nv-label">
          Choose Profile Picture (Optional)
          <input
            type="file"
            accept="image/*"
            (change)="onFileSelected($event)"
            class="nv-input"
          />
        </label>
        @if (formValue().profilePicture) {
          <div class="nv-hint text-green-600 dark:text-green-400">
            Selected: {{ formValue().profilePicture?.name }}
          </div>
        }
      </div>
    </div>

    <!-- Submit Button -->
    <button type="submit" class="nv-btn">Save Profile</button>

    <!-- Form State Debug (Development Only) -->
    <div class="form-section">
      <h4 class="form-section-title">Form State</h4>
      <div class="form-help">
        <div>Valid: {{ vestForm.formState().valid }}</div>
        <div>Errors: {{ vestForm.formState().errors | json }}</div>
      </div>
    </div>
  </form>
</section>
